<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>YTClipper</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
            rel="stylesheet"
        >
        <script
            src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous"></script>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
            crossorigin="anonymous"></script>
    </head>

    <body class="container">
        <div class="container">
            <div class="row">
                <div class="col-md-10 mx-auto">
                    <h2>CLIPPER</h2>
                    <form id="clipper-form" class="form-inline my-3" action="" method="POST">
                        {% csrf_token %}
                        <label for="url">YouTube URL:</label><br>
                        <input type="text" id="url-input" name="url"><br>

                        <input type="submit" value="Submit">
                    </form>
                </div>
            </div>
        </div>
        <script>
            const CSRF = $('input[name=csrfmiddlewaretoken]').val()
    
            $(document).ready(function () {
                console.log('document ready')
                // Handle search form submission
                $('#clipper-form').on('submit', function (event) {
                    event.preventDefault();
                    var urlQuery = $('#url-input').val();
                    console.log(urlQuery)
    
                    $.ajax({
                        type: "POST",
                        headers: {'X-CSRFToken': CSRF},
                        url: "{% url 'ajaxData' %}",
                        data: {'YTurl': urlQuery},
                        xhrFields: {responseType: 'blob'},
                        success: function (response) {
                            console.log('request succesful')
                        }
                    });
                });
            });
        </script>
        
    </body>
</html>